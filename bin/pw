#!/usr/bin/env ruby

require 'pushwagner'

def get_version
  puts "You must specify which version you wish to deploy: "
  STDIN.gets.strip
end

# TODO: detect version requirement from config
version = 1 # ENV["VERSION"] || get_version

main = Pushwagner::Main.new(:config_file => 'config/deploy.yml', :version => version, :environment => ENV['PW_ENV'] || 'staging')

# TODO: detect cli from config
case ARGV[0]
  when "deploy"
    main.deploy
    main.restart

  when "restart"
    main.restart

  else
    puts "Usage: pw <deploy|restart>"
end
